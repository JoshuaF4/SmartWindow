#define BLYNK_TEMPLATE_ID "TMPL38ONPa25_"
#define BLYNK_TEMPLATE_NAME "Test"
#define BLYNK_AUTH_TOKEN "Zurb7b7CJzhLP-
fO9cr0_myOWEc5jyzp"
#include <ESP32Servo.h>
#include <WiFi.h>
#include <BlynkSimpleEsp32.h>
Servo servo;
float angle = 10;
char ssid[] = "MG"; // Replace with your hotspot SSID
char pass[] = "gunti@12345"; // Replace with your hotspot password
void setup() {
Serial.begin(115200); // ESP32 debug serial
Serial2.begin(9600, SERIAL_8N1, 16, 17); // RX2=16, TX2=17
Serial.println("ESP32 Starting...");
Blynk.begin(BLYNK_AUTH_TOKEN, ssid, pass);
while (Blynk.connect() == false) {
Serial.print(".");
delay(1000);
}
Serial.println("\nConnected to Blynk!");
servo.attach(13);
servo.write(angle);
// Clear any residual data
while(Serial2.available()) {
Serial2.read();
}
}
BLYNK_WRITE(V1) {
bool value1 = param.asInt();
Serial.print("Blynk value received: ");
Serial.println(value1);
if (value1 == 1) {
closeWindow();
Serial2.println("0");
} else {
openWindow();
Serial2.println("1");
}
}
void loop() {
Blynk.run();
if (Serial2.available()) {
String receivedData = Serial2.readStringUntil('\n');
eceivedData.trim(); // Remove any whitespace or newline characters
Serial.print("Received data: ");
Serial.println(receivedData);
// Check if the received data is "1" or "0"
if (receivedData == "1") {
Serial.println("Opening window based on Arduino sensor data");
openWindow();
//Serial2.println(true);
}
else if (receivedData == "0") {
Serial.println("Closing window based on Arduino sensor data");
closeWindow();
//Serial2.println(false);
}
}
}
void openWindow() {
Serial.println("Opening window...");
for (angle = 110; angle >= 10; angle--) {
servo.write(angle);
delay(30);
}
Serial.println("Window opened");
}
void closeWindow() {
Serial.println("Closing window...");
for (angle = 10; angle < 110; angle++) {
servo.write(angle);
delay(20);
}
Serial.println("Window closed");
}
